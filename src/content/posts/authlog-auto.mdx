---
title: "AuthLog Auto Reporter"
author: "Ignacio Men치rguez Fern치ndez"
publishDate: 2025-02-06
description: "Herramienta en Python para analizar auth.log (SSH, sudo, autenticaciones) y generar un informe listo para tickets de SOC."
cover:
  src: "./authlog-auto.png"
  alt: "Portada del proyecto AuthLog Auto Reporter"
tags:
  - linux
  - logs
  - ssh
  - soc
  - automatizaci칩n
---

En este art칤culo presento **AuthLog Auto Reporter**, una herramienta en **Python** pensada para ayudar a un Blue Team o a un analista SOC a revisar de forma r치pida los registros de autenticaci칩n de sistemas Linux.

La idea es evitar tener que usar siempre comandos manuales (como `grep`, `awk`, `zgrep`, etc.) y disponer de un **informe repetible**, con secciones claras, que se pueda adjuntar a un ticket o compartir con el equipo.

---

## 游꿢 Objetivo del proyecto

En muchos ejercicios de laboratorio y en m치quinas de pr치ctica me encontraba siempre con el mismo problema:

- Tardaba tiempo en localizar de un vistazo los **intentos fallidos** de login.
- No ten칤a un resumen claro de **IPs m치s activas**, usuarios m치s atacados o comandos `sudo` ejecutados.
- Cuando quer칤a documentar lo que hab칤a encontrado, ten칤a que copiar y pegar a mano salidas de comandos.

El objetivo de este proyecto fue crear un **flujo semi-automatizado** que:

1. Lea el fichero `auth.log` (o sus rotaciones).
2. Extraiga la informaci칩n m치s interesante para un analista SOC.
3. Genere un **informe en Markdown** listo para pegar en un ticket (Jira, GitHub, Redmine, etc.).

---

## 游늵 Qu칠 informaci칩n extrae

El script est치 pensado para generar, como m칤nimo, estas secciones:

1. **Top IPs con intentos de login fallidos**  
   Direcciones IP con m치s eventos `Failed password` o similares.

2. **Usuarios m치s atacados**  
   Cuentas que han recibido m치s intentos de autenticaci칩n fallidos.

3. **Logins aceptados**  
   Conexiones exitosas (por ejemplo `Accepted password`, `publickey`, etc.), 칰tiles para comprobar accesos leg칤timos.

4. **Uso de sudo / escaladas**  
   Comandos ejecutados con `sudo`, qui칠n los ha lanzado y desde qu칠 terminal/host.

5. **Eventos sospechosos adicionales**  
   - Intentos desde IPs externas inusuales.  
   - Accesos fuera de horario.  
   - Usuarios de sistema que no deber칤an iniciar sesi칩n.

Cada secci칩n se genera en formato Markdown para que sea f치cil de leer y de pegar en un ticket.

---

## 丘뙖잺 Flujo de trabajo

El flujo t칤pico ser칤a:

1. Copiar el fichero `auth.log` (o `auth.log.1`, archivos rotados, etc.) a una carpeta de trabajo.
2. Ejecutar el script de Python indicando la ruta del log de entrada y la ruta del informe de salida.
3. Revisar el informe generado, a침adir comentarios manuales si hace falta y adjuntarlo al ticket del SOC.

---

## 游빍 Ejemplo de uso

Un ejemplo de ejecuci칩n podr칤a ser:

```bash
python3 authlog_auto_reporter.py \
  --log /var/log/auth.log \
  --output informes/2025-02-06-authlog-auto.md
