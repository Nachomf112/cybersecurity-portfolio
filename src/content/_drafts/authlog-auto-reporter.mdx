---
title: "AuthLog Auto Reporter: res√∫menes r√°pidos de auth.log"
description: "Herramienta en Python que resume auth.log en un informe Markdown con IPs maliciosas, usuarios atacados y logins v√°lidos, lista para pegar en un ticket de SOC y ahorrar tiempo en el triage. ‚è±Ô∏èüîê"
publishDate: 2025-02-10
cover:
  src: "/images/authlog-auto/authlog-auto.png"
  alt: "Portada del informe generado por AuthLog Auto Reporter"
tags: ["blue-team", "python", "linux", "logs", "automation"]
---
Cuando hay un incidente de seguridad, el analista SOC suele empezar en el mismo sitio: **los logs de autenticaci√≥n**. Ah√≠ est√°n los intentos de fuerza bruta, los usuarios probados, las IPs raras que no deber√≠an estar ah√≠‚Ä¶ pero leer `auth.log` a pelo puede ser un dolor üòµ‚Äçüí´.

En este art√≠culo cuento c√≥mo funciona **AuthLog Auto Reporter**, una herramienta en **Python** que he creado para **resumir lo m√°s importante de un fichero `auth.log`** y dejarlo listo para pegar en un ticket del SOC o en un informe t√©cnico. üßæ  

El objetivo es muy simple: **ahorrar tiempo en el triage** y que el analista pueda centrarse en tomar decisiones, no en pelearse con l√≠neas de log.

---

## üîç ¬øQu√© problema resuelve?

Cuando hay fuerza bruta o actividad sospechosa en SSH / sudo suele ocurrir que:

- Leer `auth.log` l√≠nea a l√≠nea es **lento y repetitivo**.
- Es f√°cil **saltarse patrones** si est√°s cansado o tienes varios casos abiertos.
- Tienes que convertir lo que ves en el log en algo legible para el ticket:  
  *‚ÄúTop IPs, usuarios atacados, logins correctos, rango de fechas‚Ä¶‚Äù*

Ah√≠ es donde entra **AuthLog Auto Reporter**. El script:

- Agrupa las **IPs con m√°s intentos de login fallidos**.
- Lista los **usuarios m√°s atacados**.
- Resume los **usuarios que s√≠ han conseguido login**.
- Deja todo en un **informe Markdown** limpio y directo para el ticket.

La idea es que el analista SOC pase de un **log ruidoso** a un **resumen accionable** en segundos. ‚ö°

---

## ‚öôÔ∏è ¬øC√≥mo funciona la herramienta?

A nivel alto, el flujo interno es:

1. **Lee el fichero de log** que le pasas por par√°metro (`auth.log`, `secure`, etc.).
2. **Detecta intentos fallidos y logins v√°lidos** seg√∫n los patrones t√≠picos de SSH / sudo.
3. **Cuenta y agrupa**:
   - IPs con m√°s intentos fallidos.
   - Usuarios m√°s atacados.
   - Usuarios con logins aceptados.
4. **Genera un informe en Markdown** con:
   - Fichero analizado.
   - Rango de fechas observado.
   - Tablas con IPs / usuarios / logins.
   - Una peque√±a nota final para el ticket.

El comando b√°sico de uso es:

```bash
python authlog_reporter.py -i samples/auth.log

# AuthLog Auto Reporter

Informe generado autom√°ticamente a partir del fichero: `samples/auth.log`

- **Fichero analizado**: `samples/auth.log`
- **Periodo observado**: 2025-01-10 10:10:10 ‚Üí 2025-01-10 10:13:13

## Top IPs con intentos de login fallidos

| IP      | Intentos fallidos |
|---------|-------------------|
| 1.2.3.4 | 10                |
| 5.6.7.8 | 7                 |

## Usuarios m√°s atacados (intentos fallidos)

| Usuario | Intentos fallidos |
|---------|-------------------|
| root    | 8                 |
| admin   | 5                 |

## Usuarios con logins aceptados

| Usuario | Logins aceptados  |
|---------|-------------------|
| nacho   | 1                 |

_Consejo_: copia este informe en el ticket del SOC y a√±ade detalles del caso  
(alerta original, acciones de contenci√≥n, bloqueo de IPs, etc.).
