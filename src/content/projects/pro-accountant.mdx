---
title: "Automated Nmap Scan & Reporting Tool"
summary: "Bash-based tool that runs scheduled Nmap scans and generates reports for Blue Team investigations."
tags:
  - Bash
  - Nmap
  - Linux
  - Automation
startDate: 2024-01-01
endDate: 2024-02-01
author: "Ignacio MenÃ¡rguez FernÃ¡ndez"
url: "https://github.com/Nachomf112"
cover: "./images/nmap-scan-alt/nmap-scan-alt.png"
ogImage: "./images/nmap-scan-alt/nmap-scan-alt.png"
---

## ğŸ“š Table of Contents

1. [ğŸ” Overview](#-overview)  
2. [ğŸ‘¨â€ğŸ’» Role](#-role)  
3. [â“ Problem](#-problem)  
4. [ğŸ¯ Goal](#-goal)  
5. [âœ¨ Solution](#-solution)  
   - [ğŸ—ï¸ Architecture](#ï¸-architecture)  
   - [ğŸ§© Core Features](#-core-features)  
   - [ğŸ” Workflow](#-workflow)  
6. [ğŸ§ª User Testing](#-user-testing)  
7. [âš™ï¸ Challenges and Learnings](#ï¸-challenges-and-learnings)  
8. [âœ… Final Thoughts](#-final-thoughts)

---

## ğŸ” Overview

**Automated Nmap Scan & Reporting Tool** is a **Bash-based automation framework** that runs scheduled **Nmap** scans against internal networks and generates reports to support **Blue Team investigations**.

The idea is to have a small, repeatable tool that:

- ğŸ•’ Uses predefined scan profiles on a regular basis.  
- ğŸ“‚ Organizes results in a consistent folder structure.  
- ğŸ“‘ Produce reports that analysts can review quickly during incidents or periodic checks.  

---

## ğŸ‘¨â€ğŸ’» Role

I was responsible for:

- ğŸ§  Designing the scan profiles and folder structure.  
- ğŸ’» Writing the Bash scripts that orchestrate Nmap and post-processing.  
- ğŸ” Preparing the output so it is easy to interpret by SOC / Blue Team analysts.  

---

## â“ Problem

Manual Nmap scans have several issues:

- â³ They are **time-consuming** and easy to forget.  
- ğŸ“Š Parameters change from one scan to another, making results **hard to compare**.  
- ğŸ—ƒï¸ Outputs often end up in random folders without a clear structure.  

For a Blue Team, this makes it difficult to:

- Mantain regular baseline scans.  
- Detect changes in exposed services.  
- Reuse results during investigations.  

---

## ğŸ¯ Goal

Create an automation that:

- âš™ï¸ Runs Nmap scans on a **regular schedule** or on demand.  
- ğŸ“‹ Uses **standardized profiles** (quick scan, full scan, vuln scanâ€¦).  
- ğŸ“ Stores results in an organized way, **tagged by date and target**.  
- ğŸ§¾ Generates summaries that speed up triage during investigations.  

---

## âœ¨ Solution

### ğŸ—ï¸ Architecture

The tool is built around a set of Bash scripts that:

- ğŸ“œ Read a **targets list** or IP ranges.  
- ğŸšï¸ Select the appropriate Nmap profile.  
- ğŸš€ Launch Nmap with the right options.  
- ğŸ’¾ Save outputs in multiple formats (`.gnmap`, `.xml`, `.txt`).  
- ğŸ§¾ Optionally generate a **summary report**.

Directory structure is organized like:

- `logs/` â€“ execution logs.  
- `results/YYYY-MM-DD/target/` â€“ Nmap outputs per day and per target.  

### ğŸ§© Core Features

- ğŸ”„ **Multiple scan profiles** (fast, full, version detection, vulnerability scripts).  
- ğŸ§¬ Support for **custom NSE scripts** when deeper analysis is needed.  
- ğŸ“‚ Automatic creation of folders per **date** and **target**.  
- ğŸ” Simple summary that highlights:
  - Hosts up / down.  
  - Open services per host.  
  - Potentially vulnerable services.  

### ğŸ” Workflow

1. ğŸ§¾ The analyst updates the targets file (hosts, ranges or subnets).  
2. â–¶ï¸ Runs the main script (or schedules it with `cron`).  
3. ğŸ›°ï¸ The tool launches all Nmap scans with the selected profiles.  
4. ğŸ“Š At the end, results are stored and a brief summary is generated for review.  

---

## ğŸ§ª User Testing

I validated the tool in a **lab environment**:

- ğŸŒ Different subnets with mixed Windows / Linux hosts.  
- ğŸ” â€œBefore and afterâ€ scenarios (services enabled/disabled).  

This allowed me to verify that:

- ğŸ§­ Changes in exposed ports are visible between scan runs.  
- ğŸ“ The folder structure is easy to navigate during an investigation.  

---

## âš™ï¸ Challenges and Learnings

- âš–ï¸ **Balancing speed vs. detail**: aggressive scans give more info but can be slow; I separated profiles for routine checks vs. deep dives.  
- ğŸ§® **Output parsing**: Nmap produces a lot of data; deciding what to summarize and what to keep as raw output was key.  
- ğŸ•°ï¸ **Scheduling**: integrating with `cron` required careful logging so analysts know when each scan ran and if something failed.  

---

## âœ… Final Thoughts

This project helped me practice:

- ğŸ¤– Automating security tasks with **Bash**.  
- ğŸ›°ï¸ Using **Nmap** not just as a one-off tool, but as part of a **repeatable process**.  
- ğŸ“š Structuring outputs so a Blue Team can quickly answer questions like  
  *â€œwhat changed on this host?â€* or *â€œwhich services are exposed today?â€*.

Itâ€™s a solid base that I can extend with:

- ğŸ“„ HTML or Markdown reports.  
- ğŸ§· Integration with SIEM / log platforms.  
- ğŸ›ï¸ Additional profiles focused on specific services or compliance checks.
